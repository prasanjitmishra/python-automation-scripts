INSERT INTO carwaleprotest.BudgetwiseVersionDetails -- VersionId,Price,Year
select ID, max(Price) as Price, '2015' FROM  carwaledata.Budgetwise_carversionData 
WHERE ID IN ( select distinct P.ID FROM (
			SELECT distinct ID FROM carwaledata.Budgetwise_carversionData
			where New = 1 AND IsDeleted <> 1 
			  AND ID NOT IN (   SELECT distinct ID 
								FROM carwaledata.Budgetwise_carversionData
								 where (LaunchDate  > '2015-12-31')
							)
			UNION  
			 
			SELECT distinct ID FROM carwaledata.Budgetwise_carversionData
			where (Discontinuation_date  > '2015-12-31' AND LaunchDate  < '2015-12-31') 
			 )P
       )
group BY ID
having Price > 0